<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Getting started with collaboration | Foxit PDF SDK For Web - V8.4.0</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script src="/docs/developer-guide/resetHref.js"></script>
    <link rel="icon" href="/docs/developer-guide/favicon.ico">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800">
    <meta name="description" content="Foxit PDF SDK For Web development guide">
    
    <link rel="preload" href="/docs/developer-guide/assets/css/0.styles.cb6848e9.css" as="style"><link rel="preload" href="/docs/developer-guide/assets/js/app.e7182497.js" as="script"><link rel="preload" href="/docs/developer-guide/assets/js/2.14e0b4fd.js" as="script"><link rel="preload" href="/docs/developer-guide/assets/js/10.09f62d98.js" as="script"><link rel="prefetch" href="/docs/developer-guide/assets/js/100.9c1f50c4.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/101.347e536e.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/102.ac05460c.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/103.419cc7b7.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/104.1ff587bf.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/105.26dbaff0.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/106.262203ad.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/107.2e3fde18.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/108.48224f63.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/109.a54934b3.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/11.ea31a896.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/110.d13e4d26.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/111.42d0b232.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/112.8c6a5af0.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/113.0e000629.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/114.a546e1a4.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/115.71e5fa01.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/116.73b353bf.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/117.a902d336.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/118.c4d897fb.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/119.026e3d55.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/12.352e6a34.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/120.f5ea7fef.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/121.5a309efe.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/122.fc8f421b.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/123.b48d0cde.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/124.58ed393b.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/125.b45bca58.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/126.9bfbf384.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/127.47201642.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/128.d51164ee.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/129.0e5b4bfb.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/13.d3835fe7.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/130.44384bfe.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/131.a7e8577c.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/132.6714a512.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/133.810b2876.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/134.45d98fa7.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/135.9281f3b5.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/136.6f440bb7.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/137.bdcb772e.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/138.47bf8602.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/139.62416ced.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/14.ca0480b6.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/15.627c299e.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/16.d5fe115a.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/17.35f44f90.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/18.ee502251.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/19.cdb07f56.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/20.9dd53eed.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/21.40c1737f.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/22.d5df31a9.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/23.ce0fe2cb.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/24.bf6a54c3.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/25.4ac82fba.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/26.0e397975.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/27.b50a1c41.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/28.74daadfa.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/29.932953b8.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/3.0d11c8fc.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/30.4403fd4f.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/31.25242c43.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/32.540f373c.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/33.b66f769c.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/34.2370823c.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/35.3e8c8aef.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/36.c570ebd3.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/37.973fd57b.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/38.e53f34a6.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/39.ee12a5af.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/4.cedf6385.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/40.bdad8579.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/41.4a1ef161.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/42.5cea54cd.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/43.92013acf.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/44.1a3c3187.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/45.56e6da30.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/46.dc74b279.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/47.892fd1b9.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/48.45f92fac.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/49.d9ff6b9f.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/5.336890e3.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/50.47d0c5a3.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/51.c63a01ee.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/52.98b2e6bb.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/53.4feb2551.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/54.c24f553a.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/55.fcd89382.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/56.9d0d0ebf.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/57.d701e3d0.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/58.ebd9b760.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/59.93876dc4.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/6.cde7f904.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/60.a75a1e25.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/61.0a5f272a.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/62.1100ff49.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/63.f4ea199f.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/64.bcb641bb.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/65.4d082b88.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/66.bd578b32.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/67.0a43e3f3.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/68.2acc901b.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/69.96dcd7d8.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/7.04052109.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/70.91099664.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/71.3af10af8.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/72.e925d0d6.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/73.d3416e5d.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/74.e23c0a97.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/75.c9adfe33.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/76.bcb572b1.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/77.5f384bbd.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/78.ced43822.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/79.42a90e93.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/8.477fa936.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/80.8a1772ca.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/81.0fc49e32.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/82.ff1234e4.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/83.e71961db.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/84.67dd8cd8.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/85.c154136e.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/86.a6944039.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/87.8117b2ce.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/88.96d5409e.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/89.0a7a6971.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/9.78dd6345.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/90.dfeed198.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/91.81228566.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/92.31e1bc5e.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/93.f8ba60dc.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/94.85a886dd.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/95.3163f8e3.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/96.77e8fc2f.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/97.391f468f.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/98.97140a79.js"><link rel="prefetch" href="/docs/developer-guide/assets/js/99.0b87ac81.js">
    <link rel="stylesheet" href="/docs/developer-guide/assets/css/0.styles.cb6848e9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/developer-guide/" class="home-link router-link-active"><!----> <span class="site-name">Foxit PDF SDK For Web - V8.4.0</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/API_Reference/FoxitPDFSDK_API_Reference.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API Reference
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/docs/developer-guide/ui-extension/" class="nav-link">
  UIExtension
</a></div><div class="nav-item"><a href="/docs/developer-guide/technical-support/" class="nav-link">
  Technical Support
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><span class="title">More</span> <span class="arrow down"></span></button> <button type="button" aria-label="More" class="mobile-dropdown-title"><span class="title">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          devtools
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.npmjs.com/package/@foxitsoftware/gulp-merge-addon" target="_blank" rel="noopener noreferrer" class="nav-link external">
  @foxitsoftware/addon-loader
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.npmjs.com/package/@foxitsoftware/addon-loader" target="_blank" rel="noopener noreferrer" class="nav-link external">
  @foxitsoftware/gulp-merge-addon
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/API_Reference/FoxitPDFSDK_API_Reference.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API Reference
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/docs/developer-guide/ui-extension/" class="nav-link">
  UIExtension
</a></div><div class="nav-item"><a href="/docs/developer-guide/technical-support/" class="nav-link">
  Technical Support
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><span class="title">More</span> <span class="arrow down"></span></button> <button type="button" aria-label="More" class="mobile-dropdown-title"><span class="title">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          devtools
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.npmjs.com/package/@foxitsoftware/gulp-merge-addon" target="_blank" rel="noopener noreferrer" class="nav-link external">
  @foxitsoftware/addon-loader
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.npmjs.com/package/@foxitsoftware/addon-loader" target="_blank" rel="noopener noreferrer" class="nav-link external">
  @foxitsoftware/gulp-merge-addon
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Getting Started</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Examples</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Features</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Collaboration</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/developer-guide/main/collaboration/getting-started.html" aria-current="page" class="active sidebar-link">Getting started with collaboration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/developer-guide/main/collaboration/getting-started.html#quickly-run-collaboration-example" class="sidebar-link">Quickly run collaboration example</a></li><li class="sidebar-sub-header"><a href="/docs/developer-guide/main/collaboration/getting-started.html#working-principle" class="sidebar-link">Working principle</a></li><li class="sidebar-sub-header"><a href="/docs/developer-guide/main/collaboration/getting-started.html#the-infinite-loop-problems" class="sidebar-link">The infinite loop problems</a></li></ul></li></ul></section></li><li><a href="/docs/developer-guide/main/best-practice.html" class="sidebar-link">Best Practice</a></li><li><a href="/docs/developer-guide/main/i18n-resources.html" class="sidebar-link">I18n Entries Resources Management</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Troubleshooting</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="getting-started-with-collaboration"><a href="#getting-started-with-collaboration" class="header-anchor">#</a> Getting started with collaboration</h1> <h2 id="quickly-run-collaboration-example"><a href="#quickly-run-collaboration-example" class="header-anchor">#</a> Quickly run collaboration example</h2> <p>Please refer to <a href="/docs/developer-guide/main/getting-started/quickly-run-samples.html">quickly-run-samples</a> to start the service, and then open the following address in the browser to access the collaboration example:</p> <p><a href="http://127.0.0.1:8080/examples/UIExtension/collaboration/index.html" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080/examples/UIExtension/collaboration/index.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="working-principle"><a href="#working-principle" class="header-anchor">#</a> Working principle</h2> <p>First, open the API reference, there are collaboration related interfaces and classes as shown below:</p> <p><img src="/docs/developer-guide/assets/img/collaboration-api-reference-class-list.5310f672.jpg" alt="Collaboration classes list in API reference"></p> <p>Among them, the operative keys are these:</p> <ol><li><p><code>CollaborationCommunicator</code></p> <p>This interface is the communication bridge between the browser and the server. It is responsible for connecting to the server, creating a collaborative session, synchronizing data, etc. In the <code>/examples/UIExtension/collaboration</code> directory, there is a sockjs based communicator, you may refer to its implementation for more details.</p></li> <li><p><code>CollabroationDataHandler</code></p> <p>Suppose we have two client devices: client A and client B. When client A creates an annotation, its related annotation data will be sent to the server, where data will be further forwarded to the client B. When client B receives the data, it immediately repeats the same operation as the client A based on the data content. At this point, the data synchronization is realized.  The above operation process of client B is implemented by the <code>CollabroationDataHandler</code> interface, which defines two methods:</p> <ul><li><p><code>accept(data: CollaborationData): Promise&lt;boolean&gt;</code></p> <p>This method will be called and used to determine whether the current  <code>CollaborationDataHandler</code> interface should handle the data when the data arrives.</p></li> <li><p><code>receive(data: CollaborationData, builtinHandler?: CollaborationDataHandler)</code></p> <p>When the <code>accept()</code> method returns true, this method will be called with two parameters. The first is the currently received collaborative data and the second is a built-in data handler. In some custom cases, you should decide whether to call the built-in data handler, since if the built-in data handler is called when the operation action is not defined in <code>COLLABORATION_ACTION</code>, there is no longer to do other synchronizing operations.</p></li></ul></li> <li><p><code>CollaborationSessionInfo</code></p> <p>When the client opens a PDF file, it will send a request to the server to create a new session. This session contains a unique shareId and information about the current PDF file. In this way, after sharing the link with the shareId to other users, the other users can open this link and see the original PDF file and start the collaboration session.</p></li> <li><p><code>UserCustomizeCollaborationData</code></p> <p>Our API design allows users to customize collaborative operations. You can send custom collaborative data through the <code>PDFViewer.collaborate</code> API, and then receive the custom collaborative data in the custom <code>CollaborationDataHandler</code> to perform synchronization.</p></li> <li><p><code>COLLABORATION_ACTION</code></p> <p>Enumerations of the built-in collaboration actions.</p></li></ol> <p>How does the collaboration work? The following section explain a complete process in details.</p> <p>Note: Our collaboration example uses Node.js as the backend server and uses websocket as a communication channel to establish a long connection for collaboration.</p> <ol><li><p>Client A opens a PDF document, where the document information will be sent to server to start a new session with a unique shareId. In the browser, you will see the address like this:
<code>http://localhost:8080/examples/UIExtension/collaboration/index.html?shareId=2MF8Rp7-Q</code></p> <iframe frameborder="0" src="https://viewer.diagrams.net/?highlight=0000ff&amp;nav=1&amp;title=#RtVfbbts4EP0aP8bQ1Y4fHTvdXaCLBkiBtk8FbY1l7lKilqRju1%2FfoUhaoqk4Dap9kTiHwxE5Zy7UJF1Vpz8EafZ%2F8wLYJImK0yRdT5JkHs%2FxqYGzAdIkN0ApaGGguAOe6Q%2BwYGTRAy1AeoqKc6Zo44NbXtewVR5GhOBHX23Hmf%2FVhpQQAM9bwkL0Cy3U3qD3ybzD%2FwRa7t2X49nCzFTEKduTyD0p%2BLEHpY%2BTdCU4V2ZUnVbAtO%2BcX8y6D6%2FMXjYmoFa%2FssD6XaqzOxsUeFQrcqH2vOQ1YY8d%2BiD4oS5AG4hQ6nQ%2Bct4gGCP4Dyh1tryRg%2BII7VXF7CycqPqql09zK33rzaxP1nIrnK1g9qk39%2BpJLST5QWytVmKDg4gSrFZ68TJGJ%2FAKlDijigBGFH3xrRMbJ%2BVFzy5dCkHOPYWG01rJnuUnDaCCjfg8nhmLNuCT6IqWN%2FRTXx8HZgdO6h2lg1qqh2m3gfpC2MF5ato6QTa8loDDGo4mPAX8VQwGyUeywaz2iCWMljWOt8gJCAReQCiKebO0ExuuFK90DIGkP8imtafptQ5E4%2FnDJF9fCNcG4DSU1HZxl0r9UMiHSbaGomkcZXPPwdb2%2B6IgoO0unk1zz%2B5d4tvgu53ESPS5fC97ScBeQBCRjSl8O3rSqfrQgKD4Cc3KGq1hpYSnDrpJ4qVGaaIKIveX3JcN2dK6%2FNzmfYoArdrK6d5rWpV4GEY3%2BCRb7dnvBRW4M67d%2BOFIa7Qsv0sQSPRUvpS3iA9y%2FVWCs8XCZze3MXLsqnVmre57hdqpDTHu8XWDnDQgZ8UotFGyDGhC1zZ6eKjYUjullzJtej1xSRXlXupc55TS3u8TyA%2BK0RpWl%2BYXjePVNLoqYvPQq2kUenU2glddPbwV81AXS93cdewyIiXdXrWdGj%2F61TUXLXzrmpAWu87TSq71DLer6Ga70kIvv36jhaVhC0vGaGFB8UoWkU9vesWb2ZVddaN5pW8ZMmcJDL23qabujC7L5%2FmoTTIOu%2BSrCVyBlKb0jZOIs2GKe5mWDGRanI3SxhK%2FN97N%2F4ceFt8POHfG8CAPO95upvPy7L8DdxN3sr1VYimN4qw5dZM4KvV7xRkjGy5IWzfRTNtbnG3cljFvlAM%2BkRSNSyX4v0gc0yV5XfNaM7ujjF1BPbK1WXvjTTInW8PxQNmuaFG012nXbxns1DiFOsv9BLwP63Sc5%2B6m0g%2BgbIxSvQiYjaefGtBkoAv15RLdTyrdtcxTX%2BoEEAUtXVi4NXHDxPQc%2FqscvXkpvTBx3FMFz3in0d884p9r8LMzRhdNfHLibICd2UByJ%2B%2FnBsXuV9Ikafc%2Fnj7%2BBA%3D%3D" style="width:100%;height:274px;"></iframe></li> <li><p>Client A shares the collaborative link to other clients, who will be connected to the same server once they open the link.</p> <iframe frameborder="0" src="https://viewer.diagrams.net/?highlight=0000ff&amp;layers=1&amp;nav=1&amp;title=#R3Vjfk5s2EP5rmEkfkgHJ4Pjxzs4lmWlnbsadpnnKyCCDJgJRIZ9x%2F%2FquQPwQgvqaOr1JX2z0gVba71vtLnh4m9fvJSmzX0RCuYf8pPbwzkNoHazhVwOXFggxaoFUsqSFggHYsz%2BpAX2DnlhCK%2BtBJQRXrLTBWBQFjZWFESnF2X7sKLi9aklS6gD7mHAX%2FcQSlbXoW7Qe8A%2BUpVm3chBt2js56R42nlQZScR5BOF3Ht5KIVR7lddbyjV3HS%2FtvIeFu%2F3GJC3UcyagVTvjifCTcc5sTF06b6U4FQnVE3wP358zpui%2BJLG%2BewZ5ActUzmEUwKUxR6Wi9eKegt5TiBAqcqrkBR4xE5Bv2DLRgX1D1nngGq%2BM2WzM88o8SIy%2BaW97oAAuDAsLjFwnhFRlG1VHVmte7ksqGSxEJWBgDcKQPg7QmB7CWVrAdQxcNPf6ANDcJqTKeqIr4JgV6a8CGN5hAFjehGX3v2N5Cs5wdoBfEiv2RL8kTMLOhPb44cwKsFx9qagEOd5UT2kvj6PFjGKL8uDQlieYkWdOnfAG4mBHnC1n2hXk3zkyAbWlvjzl%2FE6TAu5rLxmc45%2FJgfJHUTHFhJbjIJQS%2BeiBO6OTEpP4FifFWUG3fWbxb8NqgCKb1WAm6H2X1egGrAbh9ZjvyDxyWt%2FpFApu0yIxl7uYk6pisQ5bRaRyYSdF0MTJsVcTxIiLcIaLDpOUE30c7Lw%2FQ5BZ4VGwJoQ6Kda%2BLcU0rVTiJGNqZo2T68QQDq8YAqpSqhxDjV6928%2BTMHIk%2FEQPlYi%2FUjUUQh3sU2EhPpWtT6Wk%2BAoRzvWR2RWi0EnnyDifQE4umx6enCWJXma2ZthV5RZlA09OkB%2B5eWkmatAtTtDaoX%2FfpN0lup%2FL8UiWoyiUaYWgapuxMRz8HfuOTjcgexWgq0Wgx8Zs36JEB2%2BXywA4F3HN8AG4j1LVu%2FuCheFfhnVoMY3xf1cYuqMxR%2FT2x6YVBy9Ia7BM6%2B4Hp3XzgrTOtDFb5N2vrd%2F%2Fbf1bre2UjKOZvvw71T%2Fk1r%2FFOL7aQY6koDVTv2uK3oRm9NkQpq939Xhw6QYFbH40SQ8%2Fd%2Fb0YJjWjC6WBNfbUnCq6f886wW6beW84RXypbrX1eQEovU3dq8rNOlepy9wt%2Bte0WYmfNoyngVDGW8R3fdYkRX9cRLdjddV0yHBy6AfhGU93OysdBkP%2BacK3q61chnV5kje%2FGUg98ekWws23i5nbwFgd19lBzzuHn5j9Azv3KKkxQPj9P6yb%2B2%2BMvZ%2FGlkqF%2FuUb09N5tsBAOH0S8JrtPQVR0D6OfLmMGaQuWjxXbKUP4mqjZulZo%2FH5p%2BnKRgOX9LasBw%2BR%2BJ3fwE%3D" style="width:100%;height:343px;"></iframe></li> <li><p>Client A performs an action to create an annotation for example. The action operation data is sent to server synchronously on the background, and then forwarded to other clients.</p> <iframe frameborder="0" src="https://viewer.diagrams.net/?highlight=0000ff&amp;nav=1&amp;title=#R3Vlbc%2BI2FP41zLQPMLblCzw6Jt12Jk0ym8zu9ikjsADN2pYriwD99T3C8kWWCbk4zW5fiHQkHel85x6PUJTuP3Gcb%2F5kMUlGjhXvR2g%2BcpzADuBXEg4lATleSVhzGpckuyHc0X%2BIIlqKuqUxKbSNgrFE0FwnLlmWkaXQaJhzttO3rVii35rjNTEId0ucmNSvNBabkjp1gob%2BO6HrTXWz7c%2FKlRRXm5UkxQbHbNciocsRijhjohyl%2B4gkErsKl%2FLcbydW64dxkonnHEDlgUecbJVs6l3iUAmLi7zEcEX3BI5d5ITTlAjCgQbcAHRy25AuNiJNYMWGIU7oOoPxEl5zXKvFtWAS42IjGR4nRY6XNFvfsxwICAg0PSqh%2Bjun6RrESOgCfvFS0EfyEFMOL2P8AKQdzYBz8VAQ%2Fkj4pHhcw1kTDQUQbBFk3yIpdD4RBmJIhpZaRYHSlDJVe6bmu0bxruK6aencU9uwMrV1zbnRBgyUQvqV4xrKiRIqRXGs0FATQJvL4TZNQgkKiC%2BlpGC1V3hBkltWUEGZVMeCCcHS1oZQ6UlI9NsKZFuR0IxEtR9Zw6Bqo0BD1bFMVJFlouoPgKp33uQrLFcJ2YcyXoDUJIvVcL5McFHQpbRagbkwyS0ET4JFYi3GmFC1oPB6oKhonCRYeoMe5HrwUTfcMnq0oEoTU1vXBOpAXLAtXxJ1qh1JOoyQf4YRQLUmwmB0VFct9rM06Bsa%2FEoWBVt%2BJ6IJ%2BtLUu3oF6xS6egrB2Xew70Q6zDxjmQw5K5okHZIRybquk9I4ltdc7DZUkDuIZvLOHaQ%2FoHG2zeI61A3gP46r%2B489882o1GM0zgD%2BY5thyQC611lasIPk%2FPBN4jEJAqci%2FAWEsTWxgoow3yvIytmhPWulnKdRLe1OS3dnfe%2BtTuU5unqmweucyrV0p7K7AfCEUwH4%2BNDalssNxQse7Ftn3vXkfhiUL3ith9svCNIpKYqyVHhF4qps%2BbzntTzL6fGsitMbLWds6%2BXGuGM4bLUqyFvj53OqvgFTYMvZXTRtOzv4uuUN6uwdz%2B54v%2F%2BRmRbNOgnSdV4XFHxftxHkuu%2BVaXtK0P5UW%2FyguZYzgVXVO1TqtWcd9M3S1faCntzrnLaY5%2BZeZ2row5nIdiCOwyxTsgKcCV4wfpzMscA%2Fvm5mAynHtfS6CCFTOeCIPcoZoDBCZl1qIK8j0IeR0TsY0vdg9EShqMcKd9rTaPX1r7Y7BCKBgUjdwYJ0fiKtcMFhtBa1vB%2FY074Nat%2FXoPbs%2F66nRWZcqIGOfm5YkfuBsM5Owzr%2FuWF1nY%2BDtQot7UAZOaOLQPv9MZPWANB7FtKh76kg3qt5r0L9m5r3PRXfWuOykvfUrCnj5eSgwWZU5z3JvqyCR027Pnh37nbq5%2FqzwksLcc%2FqJNdgqjMaqDvv3lO1x0N121Uj8h7d9hlPcf%2F%2F3bbb122Xpc%2FGbkqfkrJix%2Fc1wPt%2Fb1m1MC6OX8JC2GBP832zWHGxZS8QcYIFkU1B3RFU3OGp5QX6pe0KrN5ovq3Icdb7NhmZxyrIysepOGs8L49XXyjZET5Z1i0K%2BaX3FTiVoTdbFPlxbkU3V1fhxc3n8P6Pm%2BuHMJJ%2FJtHny%2FD%2B8iG8vr65HzmReewZjONjfyQ1XiHXwHaTk3YTZZkMf20BVsJzopJ9ffJSH8aA4I06n8nGzqkmgoHbrZJjCN9AbiPZe%2BQxu%2FNPaOQYaczx3R7ntbwXJzKYNh9FSydsviyjy38B" style="width:100%;height:601px;"></iframe></li> <li><p>When other clients receive the synchronizing data, Web SDK will find the first data handler that <code>accept</code> the operation data, and process the received data using the  <code>CollaborationDataHandler</code>, and then output the same action of the Client A on screen.</p> <iframe frameborder="0" src="https://viewer.diagrams.net/?highlight=0000ff&amp;nav=1&amp;title=#R7VrRctsoFP0az%2Bw%2BJCMJ27IfEzvdPnRnMs3utH3qEAnbbJHQIBzb%2B%2FV7sUBCgsSZREqzSV9scQEJzj3nckEaoUW2%2F0PgYvMnTwkbRUG6H6HlKIriMIZfZThUhgmKKsNa0LQyhY3hhv5LtDHQ1i1NSdlqKDlnkhZtY8LznCSyZcNC8F272Yqz9lMLvCaO4SbBzLV%2BoancVNZZFDf2j4SuN%2BbJ4XRe1WTYNNYzKTc45TvLhK5GaCE4l9VVtl8QprAzuFT9PtxTWw9MkFw%2BpsNYj%2BMOs62enB6YPJjZCr7NU6I6hCN0udtQSW4KnKjaHbgXbBuZMV2tb0eEJPt7xxTWMwWGEJ4RKQ7QxNAj0DhqdqC5HuSuwTqKUWXbWDhPdTus3buub90gABcaBD8g0Wk8cFlUpFrRvYLlsiCCwoOIABvcDVhIrhuTjQ5mdJ3DdQJQHOtq%2FwdQSHG5OeKsCiVATPP1XxwAXiIw0OzISvO%2FpNkaJsPoLfziRNI78j2lAkbG1Yw%2F7GgOdy6%2Fl0SAN87Lu3U%2F3gnHYcs74dT1jmliO2fSg3OM%2Fi1nkBSUqYtcyA1f8xyzq8Z62dBXwdq0%2BcSP0Cq3%2FEOkPOgwg7eS%2ByitHvQwZBCEsFgTbZr7URSEYeWrdkzyYKK7XnMKD2nQN1ow2hh3YC35ViRE9%2BogWw%2FjUWAjRwkLRslxMJeOG4DHhbrcZuxCMRBgUyyjEDM%2F4VvCrnlJJeWK%2B7dcSp5ZDS60KCTvxBK%2BlYzmZFFH8aAvCk%2FPJ20YI5fEKBgmwkxORxiD5oqR%2FYVar2DeJE%2F15TJhuCxpooIEME66ZgtDgEQcvirsYMq6%2BM2uW%2B41sFXpYEp7Kq1uUPpm1TSdVMHuYwU%2By12PEU%2FF3Bb3bD1FfpdaDpt4HGZsz5Wdw5ho%2FjjheRTs3Kqr4WrafWh4epprXl7ZBDJEsGlQk8JPhKc5%2FR4PPztittcrFD7VceMTofcetwG6%2BGA1K1SD8oEBh50FdjZ5eFyd9mZcDWuqETyVQ%2FHj41VGyrJKUnqJ4tOTko88kg%2FHvUj%2BLGy7%2Byxu34GvViV5rj5nDrbhOZQv0vQiz7nEaslccMbwLRfHwhJL7MAPGMo25qUU%2FAdAztRKvMx5rnyyoox1TE4%2B2l2TM5qmxyzKl%2Fa3MyuhxwvFeU8L9ZkByETKmWcnEHo4EPWwTs9P874NwPA7IzTphAbPzgiZgdt4oKCP7Dt0EIkUW1ew04C%2F9EjNYINzYIx4pSTtwQlR0Im3ntyxXiv6JmWI3AV8%2BB2QyQHCwXOAcJgkIA7awbxO7vtPuUL3BOEzyfgdaSK6CuIfK5mc4yQhhfxNief3ATTDyEr%2BdMWgaQd9j2LqrVXfivGlvG9JMdVeaXjFxIMpxnPS8HcBgvilmAZ9zyHbcIqJ37hiZi%2BiGGej2aNi3H1Da8vwmRTs8N41U%2Be8L6EZ8wLL3i0sotFl3Pp9nTnxABu3cdzxhe8lwVCu%2BN%2BkyM3ZrH0yax3U3nM2%2B7Swh%2FS5iH2oOg78buw5FI67fu0vFJpZ2a8pBPmVPNjohy8ZCN0j5xVmJXmlsa8HuKeok6t54B4s1rmHs%2B8N7ckLou2mXe8Nbc%2BB42Bouwew6Pyh2F6dPL7t2B5HPzG2j90k9wu5LXnyQ70IMV9bqUzyzQoinEVtQQyX2EKx%2BQ6syoyaj%2BnQ1X8%3D" style="width:100%;height:333px;"></iframe></li></ol> <p>At this point, a complete collaborative operation is completed!</p> <h2 id="the-infinite-loop-problems"><a href="#the-infinite-loop-problems" class="header-anchor">#</a> The infinite loop problems</h2> <p>Looking at the following code, first, register the <code>DataEvent.annotationAdded</code> event to send collaborative data after the event is triggered, then register a click event on a button to create annotation via <code>PDFPage.addAnnot</code> API. The call of the <code>PDFPage.addAnnot</code> method will trigger the <code>DataEvent.annotationAdded</code> event.  This logic looks perfect. However, assuming that there are two client A and B at this time. The button of client A is clicked first and a collaborative data is sent, and then client B also calls the <code>PDFPage.addAnnot</code> method after receiving the collaborative data, and then the problem appears, because the <code>PDFPage.addAnnot</code> triggered the <code>DataEvents.annotationAdded</code> event, and the event callback sent a collaborative data, all clients would continue to send request after receiving the collaborative data. At this process an infinite loop problem rises.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> DataEvents <span class="token operator">=</span> PDFViewCtrl<span class="token punctuation">.</span><span class="token constant">PDF</span><span class="token punctuation">.</span>DataEvents<span class="token punctuation">;</span>
pdfViewer<span class="token punctuation">.</span>eventEmitter<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>DataEvents<span class="token punctuation">.</span>annotationAdded<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">annots</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> doc <span class="token operator">=</span> pdfViewer<span class="token punctuation">.</span><span class="token function">getCurrentPDFDoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    doc<span class="token punctuation">.</span><span class="token function">exportAnnotsToJSON</span><span class="token punctuation">(</span>annots<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">annotsJSONArray</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        pdfViewer<span class="token punctuation">.</span><span class="token function">collaborate</span><span class="token punctuation">(</span>PDFViewCtrl<span class="token punctuation">.</span>collab<span class="token punctuation">.</span><span class="token constant">COLLABORATION_ACTION</span><span class="token punctuation">.</span><span class="token constant">CREATE_ANNOT</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            annots<span class="token operator">:</span> annotsJSONArray
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> $button <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">'#create-square-button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$button<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> doc <span class="token operator">=</span> pdfViewer<span class="token punctuation">.</span><span class="token function">getCurrentPDFDoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    doc<span class="token punctuation">.</span><span class="token function">getPageByIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">page</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        page<span class="token punctuation">.</span><span class="token function">addAnnot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            color<span class="token operator">:</span> <span class="token number">0xff0000</span><span class="token punctuation">,</span>
            rect<span class="token operator">:</span> <span class="token punctuation">{</span>  left<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span> right<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span> top<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span> bottom<span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            flags<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'square'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> $button <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">'#create-line-button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$button<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> doc <span class="token operator">=</span> pdfViewer<span class="token punctuation">.</span><span class="token function">getCurrentPDFDoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    doc<span class="token punctuation">.</span><span class="token function">getPageByIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">page</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        page<span class="token punctuation">.</span><span class="token function">addAnnot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
            startStyle<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            endStyle<span class="token operator">:</span> <span class="token constant">PDF</span><span class="token punctuation">.</span>constant<span class="token punctuation">.</span>Ending_Style<span class="token punctuation">.</span>Square<span class="token punctuation">,</span>
            startPoint<span class="token operator">:</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            endPoint<span class="token operator">:</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            rect<span class="token operator">:</span> <span class="token punctuation">{</span>
                left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                right<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
                top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                bottom<span class="token operator">:</span> <span class="token number">100</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>To avoid the problem, we should move off the call of <code>pdfViewer.collaborate</code> from the <code>DataEvents</code> callback and place it in the click event callback.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> $button <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">'#create-square-button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$button<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> doc <span class="token operator">=</span> pdfViewer<span class="token punctuation">.</span><span class="token function">getCurrentPDFDoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    doc<span class="token punctuation">.</span><span class="token function">getPageByIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">page</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        page<span class="token punctuation">.</span><span class="token function">addAnnot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            color<span class="token operator">:</span> <span class="token number">0xff0000</span><span class="token punctuation">,</span>
            rect<span class="token operator">:</span> <span class="token punctuation">{</span>  left<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span> right<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span> top<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span> bottom<span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            flags<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'square'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">annots</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> doc<span class="token punctuation">.</span><span class="token function">exportAnnotsToJSON</span><span class="token punctuation">(</span>annots<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">annotsJSONArray</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            pdfViewer<span class="token punctuation">.</span><span class="token function">collaborate</span><span class="token punctuation">(</span>PDFViewCtrl<span class="token punctuation">.</span>collab<span class="token punctuation">.</span><span class="token constant">COLLABORATION_ACTION</span><span class="token punctuation">.</span><span class="token constant">CREATE_ANNOT</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                annots<span class="token operator">:</span> annotsJSONArray
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> $button <span class="token operator">=</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">'#create-line-button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$button<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> doc <span class="token operator">=</span> pdfViewer<span class="token punctuation">.</span><span class="token function">getCurrentPDFDoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    doc<span class="token punctuation">.</span><span class="token function">getPageByIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">page</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        page<span class="token punctuation">.</span><span class="token function">addAnnot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
            startStyle<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            endStyle<span class="token operator">:</span> <span class="token constant">PDF</span><span class="token punctuation">.</span>constant<span class="token punctuation">.</span>Ending_Style<span class="token punctuation">.</span>Square<span class="token punctuation">,</span>
            startPoint<span class="token operator">:</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            endPoint<span class="token operator">:</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            rect<span class="token operator">:</span> <span class="token punctuation">{</span>
                left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                right<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
                top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                bottom<span class="token operator">:</span> <span class="token number">100</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">annots</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> doc<span class="token punctuation">.</span><span class="token function">exportAnnotsToJSON</span><span class="token punctuation">(</span>annots<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">annotsJSONArray</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            pdfViewer<span class="token punctuation">.</span><span class="token function">collaborate</span><span class="token punctuation">(</span>PDFViewCtrl<span class="token punctuation">.</span>collab<span class="token punctuation">.</span><span class="token constant">COLLABORATION_ACTION</span><span class="token punctuation">.</span><span class="token constant">CREATE_ANNOT</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                annots<span class="token operator">:</span> annotsJSONArray
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/developer-guide/main/features/snapshot.html" class="prev">
        Snapshot tool
      </a></span> <span class="next"><a href="/docs/developer-guide/main/best-practice.html">
        Best Practice
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/developer-guide/assets/js/app.e7182497.js" defer></script><script src="/docs/developer-guide/assets/js/2.14e0b4fd.js" defer></script><script src="/docs/developer-guide/assets/js/10.09f62d98.js" defer></script>
  </body>
</html>
