(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{474:function(t,a,n){t.exports=n.p+"assets/img/collaboration-api-reference-class-list.5310f672.jpg"},519:function(t,a,n){"use strict";n.r(a);var s=n(63),e=Object(s.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"getting-started-with-collaboration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getting-started-with-collaboration"}},[t._v("#")]),t._v(" Getting started with collaboration")]),t._v(" "),s("h2",{attrs:{id:"quickly-run-collaboration-example"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#quickly-run-collaboration-example"}},[t._v("#")]),t._v(" Quickly run collaboration example")]),t._v(" "),s("p",[t._v("Please refer to "),s("RouterLink",{attrs:{to:"/main/getting-started/quickly-run-samples.html"}},[t._v("quickly-run-samples")]),t._v(" to start the service, and then open the following address in the browser to access the collaboration example:")],1),t._v(" "),s("p",[s("a",{attrs:{href:"http://127.0.0.1:8080/examples/UIExtension/collaboration/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://127.0.0.1:8080/examples/UIExtension/collaboration/index.html"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"working-principle"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#working-principle"}},[t._v("#")]),t._v(" Working principle")]),t._v(" "),s("p",[t._v("First, open the API reference, there are collaboration related interfaces and classes as shown below:")]),t._v(" "),s("p",[s("img",{attrs:{src:n(474),alt:"Collaboration classes list in API reference"}})]),t._v(" "),s("p",[t._v("Among them, the operative keys are these:")]),t._v(" "),s("ol",[s("li",[s("p",[s("code",[t._v("CollaborationCommunicator")])]),t._v(" "),s("p",[t._v("This interface is the communication bridge between the browser and the server. It is responsible for connecting to the server, creating a collaborative session, synchronizing data, etc. In the "),s("code",[t._v("/examples/UIExtension/collaboration")]),t._v(" directory, there is a sockjs based communicator, you may refer to its implementation for more details.")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("CollabroationDataHandler")])]),t._v(" "),s("p",[t._v("Suppose we have two client devices: client A and client B. When client A creates an annotation, its related annotation data will be sent to the server, where data will be further forwarded to the client B. When client B receives the data, it immediately repeats the same operation as the client A based on the data content. At this point, the data synchronization is realized.  The above operation process of client B is implemented by the "),s("code",[t._v("CollabroationDataHandler")]),t._v(" interface, which defines two methods:")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("accept(data: CollaborationData): Promise<boolean>")])]),t._v(" "),s("p",[t._v("This method will be called and used to determine whether the current  "),s("code",[t._v("CollaborationDataHandler")]),t._v(" interface should handle the data when the data arrives.")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("receive(data: CollaborationData, builtinHandler?: CollaborationDataHandler)")])]),t._v(" "),s("p",[t._v("When the "),s("code",[t._v("accept()")]),t._v(" method returns true, this method will be called with two parameters. The first is the currently received collaborative data and the second is a built-in data handler. In some custom cases, you should decide whether to call the built-in data handler, since if the built-in data handler is called when the operation action is not defined in "),s("code",[t._v("COLLABORATION_ACTION")]),t._v(", there is no longer to do other synchronizing operations.")])])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("CollaborationSessionInfo")])]),t._v(" "),s("p",[t._v("When the client opens a PDF file, it will send a request to the server to create a new session. This session contains a unique shareId and information about the current PDF file. In this way, after sharing the link with the shareId to other users, the other users can open this link and see the original PDF file and start the collaboration session.")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("UserCustomizeCollaborationData")])]),t._v(" "),s("p",[t._v("Our API design allows users to customize collaborative operations. You can send custom collaborative data through the "),s("code",[t._v("PDFViewer.collaborate")]),t._v(" API, and then receive the custom collaborative data in the custom "),s("code",[t._v("CollaborationDataHandler")]),t._v(" to perform synchronization.")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("COLLABORATION_ACTION")])]),t._v(" "),s("p",[t._v("Enumerations of the built-in collaboration actions.")])])]),t._v(" "),s("p",[t._v("How does the collaboration work? The following section explain a complete process in details.")]),t._v(" "),s("p",[t._v("Note: Our collaboration example uses Node.js as the backend server and uses websocket as a communication channel to establish a long connection for collaboration.")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Client A opens a PDF document, where the document information will be sent to server to start a new session with a unique shareId. In the browser, you will see the address like this:\n"),s("code",[t._v("http://localhost:8080/examples/UIExtension/collaboration/index.html?shareId=2MF8Rp7-Q")])]),t._v(" "),s("iframe",{staticStyle:{width:"100%",height:"274px"},attrs:{frameborder:"0",src:"https://viewer.diagrams.net/?highlight=0000ff&nav=1&title=#RtVfbbts4EP0aP8bQ1Y4fHTvdXaCLBkiBtk8FbY1l7lKilqRju1%2FfoUhaoqk4Dap9kTiHwxE5Zy7UJF1Vpz8EafZ%2F8wLYJImK0yRdT5JkHs%2FxqYGzAdIkN0ApaGGguAOe6Q%2BwYGTRAy1AeoqKc6Zo44NbXtewVR5GhOBHX23Hmf%2FVhpQQAM9bwkL0Cy3U3qD3ybzD%2FwRa7t2X49nCzFTEKduTyD0p%2BLEHpY%2BTdCU4V2ZUnVbAtO%2BcX8y6D6%2FMXjYmoFa%2FssD6XaqzOxsUeFQrcqH2vOQ1YY8d%2BiD4oS5AG4hQ6nQ%2Bct4gGCP4Dyh1tryRg%2BII7VXF7CycqPqql09zK33rzaxP1nIrnK1g9qk39%2BpJLST5QWytVmKDg4gSrFZ68TJGJ%2FAKlDijigBGFH3xrRMbJ%2BVFzy5dCkHOPYWG01rJnuUnDaCCjfg8nhmLNuCT6IqWN%2FRTXx8HZgdO6h2lg1qqh2m3gfpC2MF5ato6QTa8loDDGo4mPAX8VQwGyUeywaz2iCWMljWOt8gJCAReQCiKebO0ExuuFK90DIGkP8imtafptQ5E4%2FnDJF9fCNcG4DSU1HZxl0r9UMiHSbaGomkcZXPPwdb2%2B6IgoO0unk1zz%2B5d4tvgu53ESPS5fC97ScBeQBCRjSl8O3rSqfrQgKD4Cc3KGq1hpYSnDrpJ4qVGaaIKIveX3JcN2dK6%2FNzmfYoArdrK6d5rWpV4GEY3%2BCRb7dnvBRW4M67d%2BOFIa7Qsv0sQSPRUvpS3iA9y%2FVWCs8XCZze3MXLsqnVmre57hdqpDTHu8XWDnDQgZ8UotFGyDGhC1zZ6eKjYUjullzJtej1xSRXlXupc55TS3u8TyA%2BK0RpWl%2BYXjePVNLoqYvPQq2kUenU2glddPbwV81AXS93cdewyIiXdXrWdGj%2F61TUXLXzrmpAWu87TSq71DLer6Ga70kIvv36jhaVhC0vGaGFB8UoWkU9vesWb2ZVddaN5pW8ZMmcJDL23qabujC7L5%2FmoTTIOu%2BSrCVyBlKb0jZOIs2GKe5mWDGRanI3SxhK%2FN97N%2F4ceFt8POHfG8CAPO95upvPy7L8DdxN3sr1VYimN4qw5dZM4KvV7xRkjGy5IWzfRTNtbnG3cljFvlAM%2BkRSNSyX4v0gc0yV5XfNaM7ujjF1BPbK1WXvjTTInW8PxQNmuaFG012nXbxns1DiFOsv9BLwP63Sc5%2B6m0g%2BgbIxSvQiYjaefGtBkoAv15RLdTyrdtcxTX%2BoEEAUtXVi4NXHDxPQc%2FqscvXkpvTBx3FMFz3in0d884p9r8LMzRhdNfHLibICd2UByJ%2B%2FnBsXuV9Ikafc%2Fnj7%2BBA%3D%3D"}})]),t._v(" "),s("li",[s("p",[t._v("Client A shares the collaborative link to other clients, who will be connected to the same server once they open the link.")]),t._v(" "),s("iframe",{staticStyle:{width:"100%",height:"343px"},attrs:{frameborder:"0",src:"https://viewer.diagrams.net/?highlight=0000ff&layers=1&nav=1&title=#R3Vjfk5s2EP5rmEkfkgHJ4Pjxzs4lmWlnbsadpnnKyCCDJgJRIZ9x%2F%2FquQPwQgvqaOr1JX2z0gVba71vtLnh4m9fvJSmzX0RCuYf8pPbwzkNoHazhVwOXFggxaoFUsqSFggHYsz%2BpAX2DnlhCK%2BtBJQRXrLTBWBQFjZWFESnF2X7sKLi9aklS6gD7mHAX%2FcQSlbXoW7Qe8A%2BUpVm3chBt2js56R42nlQZScR5BOF3Ht5KIVR7lddbyjV3HS%2FtvIeFu%2F3GJC3UcyagVTvjifCTcc5sTF06b6U4FQnVE3wP358zpui%2BJLG%2BewZ5ActUzmEUwKUxR6Wi9eKegt5TiBAqcqrkBR4xE5Bv2DLRgX1D1nngGq%2BM2WzM88o8SIy%2BaW97oAAuDAsLjFwnhFRlG1VHVmte7ksqGSxEJWBgDcKQPg7QmB7CWVrAdQxcNPf6ANDcJqTKeqIr4JgV6a8CGN5hAFjehGX3v2N5Cs5wdoBfEiv2RL8kTMLOhPb44cwKsFx9qagEOd5UT2kvj6PFjGKL8uDQlieYkWdOnfAG4mBHnC1n2hXk3zkyAbWlvjzl%2FE6TAu5rLxmc45%2FJgfJHUTHFhJbjIJQS%2BeiBO6OTEpP4FifFWUG3fWbxb8NqgCKb1WAm6H2X1egGrAbh9ZjvyDxyWt%2FpFApu0yIxl7uYk6pisQ5bRaRyYSdF0MTJsVcTxIiLcIaLDpOUE30c7Lw%2FQ5BZ4VGwJoQ6Kda%2BLcU0rVTiJGNqZo2T68QQDq8YAqpSqhxDjV6928%2BTMHIk%2FEQPlYi%2FUjUUQh3sU2EhPpWtT6Wk%2BAoRzvWR2RWi0EnnyDifQE4umx6enCWJXma2ZthV5RZlA09OkB%2B5eWkmatAtTtDaoX%2FfpN0lup%2FL8UiWoyiUaYWgapuxMRz8HfuOTjcgexWgq0Wgx8Zs36JEB2%2BXywA4F3HN8AG4j1LVu%2FuCheFfhnVoMY3xf1cYuqMxR%2FT2x6YVBy9Ia7BM6%2B4Hp3XzgrTOtDFb5N2vrd%2F%2Fbf1bre2UjKOZvvw71T%2Fk1r%2FFOL7aQY6koDVTv2uK3oRm9NkQpq939Xhw6QYFbH40SQ8%2Fd%2Fb0YJjWjC6WBNfbUnCq6f886wW6beW84RXypbrX1eQEovU3dq8rNOlepy9wt%2Bte0WYmfNoyngVDGW8R3fdYkRX9cRLdjddV0yHBy6AfhGU93OysdBkP%2BacK3q61chnV5kje%2FGUg98ekWws23i5nbwFgd19lBzzuHn5j9Azv3KKkxQPj9P6yb%2B2%2BMvZ%2FGlkqF%2FuUb09N5tsBAOH0S8JrtPQVR0D6OfLmMGaQuWjxXbKUP4mqjZulZo%2FH5p%2BnKRgOX9LasBw%2BR%2BJ3fwE%3D"}})]),t._v(" "),s("li",[s("p",[t._v("Client A performs an action to create an annotation for example. The action operation data is sent to server synchronously on the background, and then forwarded to other clients.")]),t._v(" "),s("iframe",{staticStyle:{width:"100%",height:"601px"},attrs:{frameborder:"0",src:"https://viewer.diagrams.net/?highlight=0000ff&nav=1&title=#R3Vlbc%2BI2FP41zLQPMLblCzw6Jt12Jk0ym8zu9ikjsADN2pYriwD99T3C8kWWCbk4zW5fiHQkHel85x6PUJTuP3Gcb%2F5kMUlGjhXvR2g%2BcpzADuBXEg4lATleSVhzGpckuyHc0X%2BIIlqKuqUxKbSNgrFE0FwnLlmWkaXQaJhzttO3rVii35rjNTEId0ucmNSvNBabkjp1gob%2BO6HrTXWz7c%2FKlRRXm5UkxQbHbNciocsRijhjohyl%2B4gkErsKl%2FLcbydW64dxkonnHEDlgUecbJVs6l3iUAmLi7zEcEX3BI5d5ITTlAjCgQbcAHRy25AuNiJNYMWGIU7oOoPxEl5zXKvFtWAS42IjGR4nRY6XNFvfsxwICAg0PSqh%2Bjun6RrESOgCfvFS0EfyEFMOL2P8AKQdzYBz8VAQ%2Fkj4pHhcw1kTDQUQbBFk3yIpdD4RBmJIhpZaRYHSlDJVe6bmu0bxruK6aencU9uwMrV1zbnRBgyUQvqV4xrKiRIqRXGs0FATQJvL4TZNQgkKiC%2BlpGC1V3hBkltWUEGZVMeCCcHS1oZQ6UlI9NsKZFuR0IxEtR9Zw6Bqo0BD1bFMVJFlouoPgKp33uQrLFcJ2YcyXoDUJIvVcL5McFHQpbRagbkwyS0ET4JFYi3GmFC1oPB6oKhonCRYeoMe5HrwUTfcMnq0oEoTU1vXBOpAXLAtXxJ1qh1JOoyQf4YRQLUmwmB0VFct9rM06Bsa%2FEoWBVt%2BJ6IJ%2BtLUu3oF6xS6egrB2Xew70Q6zDxjmQw5K5okHZIRybquk9I4ltdc7DZUkDuIZvLOHaQ%2FoHG2zeI61A3gP46r%2B489882o1GM0zgD%2BY5thyQC611lasIPk%2FPBN4jEJAqci%2FAWEsTWxgoow3yvIytmhPWulnKdRLe1OS3dnfe%2BtTuU5unqmweucyrV0p7K7AfCEUwH4%2BNDalssNxQse7Ftn3vXkfhiUL3ith9svCNIpKYqyVHhF4qps%2BbzntTzL6fGsitMbLWds6%2BXGuGM4bLUqyFvj53OqvgFTYMvZXTRtOzv4uuUN6uwdz%2B54v%2F%2BRmRbNOgnSdV4XFHxftxHkuu%2BVaXtK0P5UW%2FyguZYzgVXVO1TqtWcd9M3S1faCntzrnLaY5%2BZeZ2row5nIdiCOwyxTsgKcCV4wfpzMscA%2Fvm5mAynHtfS6CCFTOeCIPcoZoDBCZl1qIK8j0IeR0TsY0vdg9EShqMcKd9rTaPX1r7Y7BCKBgUjdwYJ0fiKtcMFhtBa1vB%2FY074Nat%2FXoPbs%2F66nRWZcqIGOfm5YkfuBsM5Owzr%2FuWF1nY%2BDtQot7UAZOaOLQPv9MZPWANB7FtKh76kg3qt5r0L9m5r3PRXfWuOykvfUrCnj5eSgwWZU5z3JvqyCR027Pnh37nbq5%2FqzwksLcc%2FqJNdgqjMaqDvv3lO1x0N121Uj8h7d9hlPcf%2F%2F3bbb122Xpc%2FGbkqfkrJix%2Fc1wPt%2Fb1m1MC6OX8JC2GBP832zWHGxZS8QcYIFkU1B3RFU3OGp5QX6pe0KrN5ovq3Icdb7NhmZxyrIysepOGs8L49XXyjZET5Z1i0K%2BaX3FTiVoTdbFPlxbkU3V1fhxc3n8P6Pm%2BuHMJJ%2FJtHny%2FD%2B8iG8vr65HzmReewZjONjfyQ1XiHXwHaTk3YTZZkMf20BVsJzopJ9ffJSH8aA4I06n8nGzqkmgoHbrZJjCN9AbiPZe%2BQxu%2FNPaOQYaczx3R7ntbwXJzKYNh9FSydsviyjy38B"}})]),t._v(" "),s("li",[s("p",[t._v("When other clients receive the synchronizing data, Web SDK will find the first data handler that "),s("code",[t._v("accept")]),t._v(" the operation data, and process the received data using the  "),s("code",[t._v("CollaborationDataHandler")]),t._v(", and then output the same action of the Client A on screen.")]),t._v(" "),s("iframe",{staticStyle:{width:"100%",height:"333px"},attrs:{frameborder:"0",src:"https://viewer.diagrams.net/?highlight=0000ff&nav=1&title=#R7VrRctsoFP0az%2Bw%2BJCMJ27IfEzvdPnRnMs3utH3qEAnbbJHQIBzb%2B%2FV7sUBCgsSZREqzSV9scQEJzj3nckEaoUW2%2F0PgYvMnTwkbRUG6H6HlKIriMIZfZThUhgmKKsNa0LQyhY3hhv5LtDHQ1i1NSdlqKDlnkhZtY8LznCSyZcNC8F272Yqz9lMLvCaO4SbBzLV%2BoancVNZZFDf2j4SuN%2BbJ4XRe1WTYNNYzKTc45TvLhK5GaCE4l9VVtl8QprAzuFT9PtxTWw9MkFw%2BpsNYj%2BMOs62enB6YPJjZCr7NU6I6hCN0udtQSW4KnKjaHbgXbBuZMV2tb0eEJPt7xxTWMwWGEJ4RKQ7QxNAj0DhqdqC5HuSuwTqKUWXbWDhPdTus3buub90gABcaBD8g0Wk8cFlUpFrRvYLlsiCCwoOIABvcDVhIrhuTjQ5mdJ3DdQJQHOtq%2FwdQSHG5OeKsCiVATPP1XxwAXiIw0OzISvO%2FpNkaJsPoLfziRNI78j2lAkbG1Yw%2F7GgOdy6%2Fl0SAN87Lu3U%2F3gnHYcs74dT1jmliO2fSg3OM%2Fi1nkBSUqYtcyA1f8xyzq8Z62dBXwdq0%2BcSP0Cq3%2FEOkPOgwg7eS%2ByitHvQwZBCEsFgTbZr7URSEYeWrdkzyYKK7XnMKD2nQN1ow2hh3YC35ViRE9%2BogWw%2FjUWAjRwkLRslxMJeOG4DHhbrcZuxCMRBgUyyjEDM%2F4VvCrnlJJeWK%2B7dcSp5ZDS60KCTvxBK%2BlYzmZFFH8aAvCk%2FPJ20YI5fEKBgmwkxORxiD5oqR%2FYVar2DeJE%2F15TJhuCxpooIEME66ZgtDgEQcvirsYMq6%2BM2uW%2B41sFXpYEp7Kq1uUPpm1TSdVMHuYwU%2By12PEU%2FF3Bb3bD1FfpdaDpt4HGZsz5Wdw5ho%2FjjheRTs3Kqr4WrafWh4epprXl7ZBDJEsGlQk8JPhKc5%2FR4PPztittcrFD7VceMTofcetwG6%2BGA1K1SD8oEBh50FdjZ5eFyd9mZcDWuqETyVQ%2FHj41VGyrJKUnqJ4tOTko88kg%2FHvUj%2BLGy7%2Byxu34GvViV5rj5nDrbhOZQv0vQiz7nEaslccMbwLRfHwhJL7MAPGMo25qUU%2FAdAztRKvMx5rnyyoox1TE4%2B2l2TM5qmxyzKl%2Fa3MyuhxwvFeU8L9ZkByETKmWcnEHo4EPWwTs9P874NwPA7IzTphAbPzgiZgdt4oKCP7Dt0EIkUW1ew04C%2F9EjNYINzYIx4pSTtwQlR0Im3ntyxXiv6JmWI3AV8%2BB2QyQHCwXOAcJgkIA7awbxO7vtPuUL3BOEzyfgdaSK6CuIfK5mc4yQhhfxNief3ATTDyEr%2BdMWgaQd9j2LqrVXfivGlvG9JMdVeaXjFxIMpxnPS8HcBgvilmAZ9zyHbcIqJ37hiZi%2BiGGej2aNi3H1Da8vwmRTs8N41U%2Be8L6EZ8wLL3i0sotFl3Pp9nTnxABu3cdzxhe8lwVCu%2BN%2BkyM3ZrH0yax3U3nM2%2B7Swh%2FS5iH2oOg78buw5FI67fu0vFJpZ2a8pBPmVPNjohy8ZCN0j5xVmJXmlsa8HuKeok6t54B4s1rmHs%2B8N7ckLou2mXe8Nbc%2BB42Bouwew6Pyh2F6dPL7t2B5HPzG2j90k9wu5LXnyQ70IMV9bqUzyzQoinEVtQQyX2EKx%2BQ6syoyaj%2BnQ1X8%3D"}})])]),t._v(" "),s("p",[t._v("At this point, a complete collaborative operation is completed!")]),t._v(" "),s("h2",{attrs:{id:"the-infinite-loop-problems"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#the-infinite-loop-problems"}},[t._v("#")]),t._v(" The infinite loop problems")]),t._v(" "),s("p",[t._v("Looking at the following code, first, register the "),s("code",[t._v("DataEvent.annotationAdded")]),t._v(" event to send collaborative data after the event is triggered, then register a click event on a button to create annotation via "),s("code",[t._v("PDFPage.addAnnot")]),t._v(" API. The call of the "),s("code",[t._v("PDFPage.addAnnot")]),t._v(" method will trigger the "),s("code",[t._v("DataEvent.annotationAdded")]),t._v(" event.  This logic looks perfect. However, assuming that there are two client A and B at this time. The button of client A is clicked first and a collaborative data is sent, and then client B also calls the "),s("code",[t._v("PDFPage.addAnnot")]),t._v(" method after receiving the collaborative data, and then the problem appears, because the "),s("code",[t._v("PDFPage.addAnnot")]),t._v(" triggered the "),s("code",[t._v("DataEvents.annotationAdded")]),t._v(" event, and the event callback sent a collaborative data, all clients would continue to send request after receiving the collaborative data. At this process an infinite loop problem rises.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" DataEvents "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" PDFViewCtrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PDF")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DataEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npdfViewer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventEmitter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DataEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotationAdded"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("annots")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" doc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pdfViewer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCurrentPDFDoc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exportAnnotsToJSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("annots"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("annotsJSONArray")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        pdfViewer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("collaborate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PDFViewCtrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("collab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COLLABORATION_ACTION")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CREATE_ANNOT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            annots"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" annotsJSONArray\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" $button "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("jQuery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#create-square-button'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n$button"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" doc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pdfViewer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCurrentPDFDoc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPageByIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("page")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAnnot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            color"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xff0000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            rect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  left"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" right"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" top"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bottom"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            flags"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'square'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" $button "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("jQuery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#create-line-button'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n$button"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" doc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pdfViewer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCurrentPDFDoc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPageByIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("page")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAnnot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'line'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            startStyle"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            endStyle"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PDF")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("constant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Ending_Style"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Square"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            startPoint"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            endPoint"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            rect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                left"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                right"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                top"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                bottom"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("To avoid the problem, we should move off the call of "),s("code",[t._v("pdfViewer.collaborate")]),t._v(" from the "),s("code",[t._v("DataEvents")]),t._v(" callback and place it in the click event callback.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" $button "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("jQuery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#create-square-button'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n$button"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" doc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pdfViewer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCurrentPDFDoc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPageByIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("page")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAnnot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            color"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xff0000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            rect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  left"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" right"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" top"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bottom"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            flags"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'square'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("annots")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exportAnnotsToJSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("annots"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("annotsJSONArray")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            pdfViewer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("collaborate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PDFViewCtrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("collab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COLLABORATION_ACTION")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CREATE_ANNOT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                annots"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" annotsJSONArray\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" $button "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("jQuery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#create-line-button'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n$button"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" doc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pdfViewer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCurrentPDFDoc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPageByIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("page")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAnnot")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'line'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            startStyle"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            endStyle"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PDF")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("constant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Ending_Style"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Square"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            startPoint"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            endPoint"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            rect"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                left"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                right"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                top"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                bottom"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("annots")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" doc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exportAnnotsToJSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("annots"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("annotsJSONArray")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            pdfViewer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("collaborate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PDFViewCtrl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("collab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COLLABORATION_ACTION")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CREATE_ANNOT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                annots"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" annotsJSONArray\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);